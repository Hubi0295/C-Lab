#include <stdio.h>
#include <string.h>
#include <stdlib.h>
struct hotel{
    char pokoju[3];
    float cena;
    int status;
};
float zysk(int n, struct hotel tablicka[]);
int rezerwacja(int n, struct hotel tablicka[]);
void koszt(int n, struct hotel tablicka[], int cennik[]);
struct hotel *wolne(int n, struct hotel tablicka[], int *wk);
char* rezerwacjaa(struct hotel tablica[], int);
double* koszty(struct hotel tablica[], int);
int main(){
    int n,i,czwarte;
    float trzecie;
    puts("Podaj liczbe pokoi: ");
    scanf("%d", &n);
    int pierwsze[n];
    struct hotel tablica[n];
    for(i=0;i<n;i++){
        printf("Podaj kod pokoju p%d: ", i+1);
        fflush(stdin);
        gets(tablica[i].pokoju);
        printf("Podaj cene za pokoj p%d: ", i+1);
        scanf("%f", &tablica[i].cena);
        printf("Podaj status za pokoj p%d: ", i+1);
        scanf("%d", &tablica[i].status);
    }
    printf("\n");
    for(i=0;i<n;i++){
        printf("Pokoj p%d o nazwie:%s, cena:%f, status:%d: \n", i+1, tablica[i].pokoju, tablica[i].cena, tablica[i].status);
    }
    trzecie = zysk(n,tablica);
    printf("Zysk: %f\n", trzecie);
    czwarte = rezerwacja(n,tablica);
    if(czwarte==1){
        printf("Pokoj dla 3 osob jest wolny\n");
    }
    if(czwarte==0){
        printf("Pokoj dla 3 osob nie jest wolny\n");
    }
    koszt(n,tablica,pierwsze);
    for(i=0;i<n;i++){
        printf("Cena pokoju nr%d wynosi:%d\n",i+1, pierwsze[i]);
    }
    int wki, *wskaznik_do_wk;
    wskaznik_do_wk = &wki;
    struct hotel *drugie = wolne(n,tablica,wskaznik_do_wk);
    for(i=0;i<wki;i++){
        printf("Jaki wolny: %s\n", drugie[i].pokoju);
        printf("Cena: %f", drugie[i].cena);
    }
    printf("\nCzy sa wolne pokoje p3: %s", rezerwacjaa(tablica, n));

    double *M;
    M = koszty(tablica, n);
    for(i=0;i<n;i++){
        printf("\nDla pokoju <%s> cena dla jednej osoby wynosi: %f zl", tablica[i].pokoju, M[i]);
    }
}



float zysk(int n, struct hotel tablicka[]){
    int i, zarobek=0;
    for(i=0;i<n;i++){
        if(tablicka[i].status==2){
            zarobek+=tablicka[i].cena;
        }
    }
    return zarobek;
}
int rezerwacja(int n, struct hotel tablicka[]){
    int i, rezerw=0;
    char p[3]="p3";
    for(i=0;i<n;i++){
        if(strcmp(tablicka[i].pokoju,p)==0){
            if(tablicka[i].status==1){
                rezerw=1;
            }
        }
    }
    return rezerw;
}
void koszt(int n, struct hotel tablicka[], int cennik[]){
    int i;
    for(i=0;i<n;i++){
        cennik[i]=tablicka[i].cena;
    }
}
struct hotel *wolne(int n, struct hotel tablicka[], int *wk){
    int i, k=0;
    for(i=0;i<n;i++){
        if (tablicka[i].status ==1){
            k+=1;
        }
    }
    *wk=k;
    int d=0;
    struct hotel *TH = (struct hotel*)malloc(k*sizeof(struct hotel));
    for(i=0;i<n;i++){
        if(tablicka[i].status == 1){
            strcpy(TH[d].pokoju,tablicka[i].pokoju);
            TH[d].cena = tablicka[i].cena;
            d+=1;
        }
    }
    return TH;
};//Kolegi
char* rezerwacjaa(struct hotel tablica[], int n){
    int i;
    char *rez = (char*) malloc (4 * sizeof(char));
    for(i=0;i<n;i++){
        if(tablica[i].pokoju[1] == '3'){
            if(tablica[i].status == 1){
                strcpy(rez, "tak");
                return rez;
            }
        }
    }
    strcpy(rez, "nie");
    return rez;

}
double* koszty(struct hotel tablica[], int n){
    double* tab=(double *)malloc( n * sizeof (int) );
    int i;
    for (i=0;i<n;i++){
        if(tablica[i].pokoju[1] == '1'){
            tab[i] = tablica[i].cena/1;
        }
        if (tablica[i].pokoju[1] == '2'){
            tab[i] = tablica[i].cena/2;
        }
        if (tablica[i].pokoju[1] == '3'){
            tab[i] = tablica[i].cena/3;
        }
    }
    return tab;
}
